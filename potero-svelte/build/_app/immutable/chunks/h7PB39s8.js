const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./dpo3E_rx.js","./CBfW9mKF.js","./Cxiy8xzw.js","./BAb15ZmS.js","./DTVzISQa.js","./CDd--OGd.js","./C-_Un3-0.js"])))=>i.map(i=>d[i]);
import{i as m,b as Fr,_ as jt,s as tt,d as ca,e as ua,a as va}from"./CBfW9mKF.js";import{f as v,a as d,d as $t,c as vt}from"./CDd--OGd.js";import{d as Bt,w as Re,o as xr,a as pa}from"./DTVzISQa.js";import{f as fa,h as We,Q as ga,w as r,ay as ma,Y as _a,Z as ha,_ as Lr,k as or,j as ir,e as Kt,C as xa,at as ba,af as Dr,c as mt,a as lr,aJ as _t,b as fr,s as ya,a7 as Rr,a3 as wa,ar as br,aK as Br,aL as Ca,aM as Ea,aN as ka,r as zr,p as Gr,aO as dr,i as Sa,aq as Ia,d as Ta,g as Pa,aP as qr,a1 as Hr,aQ as Aa,aR as jr,$ as Ma,a4 as La,aS as Da,aT as Ra,aU as Kr,aV as $a,aW as Na,aX as Ua,aY as Oa,aZ as Va,aH as Fa,F as Ba,a0 as za,l as zt,n as se,o as Zt,u as gr,y,q as n,t as o,z as s,a_ as Ga,v as w,x as Gt,aI as Et,A as Ot,B as qe}from"./Cxiy8xzw.js";import{d as qt,s as _,e as yt}from"./C-_Un3-0.js";function Rt(e,t){return t}function qa(e,t,a){for(var i=[],u=t.length,c,l=t.length,f=0;f<u;f++){let de=t[f];Gr(de,()=>{if(c){if(c.pending.delete(de),c.done.add(de),c.pending.size===0){var O=e.outrogroups;mr(br(c.done)),O.delete(c),O.size===0&&(e.outrogroups=null)}}else l-=1},!1)}if(l===0){var b=i.length===0&&a!==null;if(b){var C=a,T=C.parentNode;Ia(T),T.append(C),e.items.clear()}mr(t,!b)}else c={pending:new Set(t),done:new Set},(e.outrogroups??=new Set).add(c)}function mr(e,t=!0){for(var a=0;a<e.length;a++)Ta(e[a],t)}var $r;function it(e,t,a,i,u,c=null){var l=e,f=new Map,b=(t&qr)!==0;if(b){var C=e;l=We?or(Pa(C)):C.appendChild(lr())}We&&ga();var T=null,de=ma(()=>{var k=a();return Br(k)?k:k==null?[]:br(k)}),O,Y=!0;function re(){h.fallback=T,Ha(h,O,l,t,i),T!==null&&(O.length===0?(T.f&_t)===0?zr(T):(T.f^=_t,Vt(T,null,l)):Gr(T,()=>{T=null}))}var V=fa(()=>{O=r(de);var k=O.length;let A=!1;if(We){var U=_a(l)===ha;U!==(k===0)&&(l=Lr(),or(l),ir(!1),A=!0)}for(var R=new Set,I=mt,H=ya(),z=0;z<k;z+=1){We&&Kt.nodeType===xa&&Kt.data===ba&&(l=Kt,A=!0,ir(!1));var G=O[z],Q=i(G,z),j=Y?null:f.get(Q);j?(j.v&&Dr(j.v,G),j.i&&Dr(j.i,z),H&&I.skipped_effects.delete(j.e)):(j=ja(f,Y?l:$r??=lr(),G,Q,z,u,t,a),Y||(j.e.f|=_t),f.set(Q,j)),R.add(Q)}if(k===0&&c&&!T&&(Y?T=fr(()=>c(l)):(T=fr(()=>c($r??=lr())),T.f|=_t)),We&&k>0&&or(Lr()),!Y)if(H){for(const[K,x]of f)R.has(K)||I.skipped_effects.add(x.e);I.oncommit(re),I.ondiscard(()=>{})}else re();A&&ir(!0),r(de)}),h={effect:V,items:f,outrogroups:null,fallback:T};Y=!1,We&&(l=Kt)}function Ha(e,t,a,i,u){var c=(i&Aa)!==0,l=t.length,f=e.items,b=e.effect.first,C,T=null,de,O=[],Y=[],re,V,h,k;if(c)for(k=0;k<l;k+=1)re=t[k],V=u(re,k),h=f.get(V).e,(h.f&_t)===0&&(h.nodes?.a?.measure(),(de??=new Set).add(h));for(k=0;k<l;k+=1){if(re=t[k],V=u(re,k),h=f.get(V).e,e.outrogroups!==null)for(const j of e.outrogroups)j.pending.delete(h),j.done.delete(h);if((h.f&_t)!==0)if(h.f^=_t,h===b)Vt(h,null,a);else{var A=T?T.next:b;h===e.effect.last&&(e.effect.last=h.prev),h.prev&&(h.prev.next=h.next),h.next&&(h.next.prev=h.prev),wt(e,T,h),wt(e,h,A),Vt(h,A,a),T=h,O=[],Y=[],b=T.next;continue}if((h.f&dr)!==0&&(zr(h),c&&(h.nodes?.a?.unfix(),(de??=new Set).delete(h))),h!==b){if(C!==void 0&&C.has(h)){if(O.length<Y.length){var U=Y[0],R;T=U.prev;var I=O[0],H=O[O.length-1];for(R=0;R<O.length;R+=1)Vt(O[R],U,a);for(R=0;R<Y.length;R+=1)C.delete(Y[R]);wt(e,I.prev,H.next),wt(e,T,I),wt(e,H,U),b=U,T=H,k-=1,O=[],Y=[]}else C.delete(h),Vt(h,b,a),wt(e,h.prev,h.next),wt(e,h,T===null?e.effect.first:T.next),wt(e,T,h),T=h;continue}for(O=[],Y=[];b!==null&&b!==h;)(C??=new Set).add(b),Y.push(b),b=b.next;if(b===null)continue}(h.f&_t)===0&&O.push(h),T=h,b=h.next}if(e.outrogroups!==null){for(const j of e.outrogroups)j.pending.size===0&&(mr(br(j.done)),e.outrogroups?.delete(j));e.outrogroups.size===0&&(e.outrogroups=null)}if(b!==null||C!==void 0){var z=[];if(C!==void 0)for(h of C)(h.f&dr)===0&&z.push(h);for(;b!==null;)(b.f&dr)===0&&b!==e.fallback&&z.push(b),b=b.next;var G=z.length;if(G>0){var Q=(i&qr)!==0&&l===0?a:null;if(c){for(k=0;k<G;k+=1)z[k].nodes?.a?.measure();for(k=0;k<G;k+=1)z[k].nodes?.a?.fix()}qa(e,z,Q)}}c&&Hr(()=>{if(de!==void 0)for(h of de)h.nodes?.a?.apply()})}function ja(e,t,a,i,u,c,l,f){var b=(l&Ca)!==0?(l&Ea)===0?wa(a,!1,!1):Rr(a):null,C=(l&ka)!==0?Rr(u):null;return{v:b,i:C,e:fr(()=>(c(t,b??a,C??u,f),()=>{e.delete(i)}))}}function Vt(e,t,a){if(e.nodes)for(var i=e.nodes.start,u=e.nodes.end,c=t&&(t.f&_t)===0?t.nodes.start:a;i!==null;){var l=Sa(i);if(c.before(i),i===u)return;i=l}}function wt(e,t,a){t===null?e.effect.first=a:t.next=a,a===null?e.effect.last=t:a.prev=t}function Jr(e){var t,a,i="";if(typeof e=="string"||typeof e=="number")i+=e;else if(typeof e=="object")if(Array.isArray(e)){var u=e.length;for(t=0;t<u;t++)e[t]&&(a=Jr(e[t]))&&(i&&(i+=" "),i+=a)}else for(a in e)e[a]&&(i&&(i+=" "),i+=a);return i}function Ka(){for(var e,t,a=0,i="",u=arguments.length;a<u;a++)(e=arguments[a])&&(t=Jr(e))&&(i&&(i+=" "),i+=t);return i}function Ja(e){return typeof e=="object"?Ka(e):e??""}function Wa(e,t,a){var i=e==null?"":""+e;return i===""?null:i}function Xa(e,t){return e==null?null:String(e)}function fe(e,t,a,i,u,c){var l=e.__className;if(We||l!==a||l===void 0){var f=Wa(a);(!We||f!==e.getAttribute("class"))&&(f==null?e.removeAttribute("class"):t?e.className=f:e.setAttribute("class",f)),e.__className=a}return c}function Qa(e,t,a,i){var u=e.__style;if(We||u!==t){var c=Xa(t);(!We||c!==e.getAttribute("style"))&&(c==null?e.removeAttribute("style"):e.style.cssText=c),e.__style=t}return i}function Wr(e,t,a=!1){if(e.multiple){if(t==null)return;if(!Br(t))return Da();for(var i of e.options)i.selected=t.includes(Ft(i));return}for(i of e.options){var u=Ft(i);if(Ra(u,t)){i.selected=!0;return}}(!a||t!==void 0)&&(e.selectedIndex=-1)}function Ya(e){var t=new MutationObserver(()=>{Wr(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),La(()=>{t.disconnect()})}function Xr(e,t,a=t){var i=new WeakSet,u=!0;jr(e,"change",c=>{var l=c?"[selected]":":checked",f;if(e.multiple)f=[].map.call(e.querySelectorAll(l),Ft);else{var b=e.querySelector(l)??e.querySelector("option:not([disabled])");f=b&&Ft(b)}a(f),mt!==null&&i.add(mt)}),Ma(()=>{var c=t();if(e===document.activeElement){var l=Kr??mt;if(i.has(l))return}if(Wr(e,c,u),u&&c===void 0){var f=e.querySelector(":checked");f!==null&&(c=Ft(f),a(c))}e.__value=c,u=!1}),Ya(e)}function Ft(e){return"__value"in e?e.__value:e.value}const Za=Symbol("is custom element"),es=Symbol("is html");function Jt(e){if(We){var t=!1,a=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var i=e.value;Ct(e,"value",null),e.value=i}if(e.hasAttribute("checked")){var u=e.checked;Ct(e,"checked",null),e.checked=u}}};e.__on_r=a,Hr(a),$a()}}function ts(e,t){var a=Qr(e);a.value===(a.value=t??void 0)||e.value===t&&(t!==0||e.nodeName!=="PROGRESS")||(e.value=t??"")}function Ct(e,t,a,i){var u=Qr(e);We&&(u[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||u[t]!==(u[t]=a)&&(t==="loading"&&(e[Oa]=a),a==null?e.removeAttribute(t):typeof a!="string"&&rs(e).includes(t)?e[t]=a:e.setAttribute(t,a))}function Qr(e){return e.__attributes??={[Za]:e.nodeName.includes("-"),[es]:e.namespaceURI===Na}}var Nr=new Map;function rs(e){var t=e.getAttribute("is")||e.nodeName,a=Nr.get(t);if(a)return a;Nr.set(t,a=[]);for(var i,u=e,c=Element.prototype;c!==u;){i=Va(u);for(var l in i)i[l].set&&a.push(l);u=Ua(u)}return a}function Qt(e,t,a=t){var i=new WeakSet;jr(e,"input",async u=>{var c=u?e.defaultValue:e.value;if(c=cr(e)?ur(c):c,a(c),mt!==null&&i.add(mt),await Fa(),c!==(c=t())){var l=e.selectionStart,f=e.selectionEnd,b=e.value.length;if(e.value=c??"",f!==null){var C=e.value.length;l===f&&f===b&&C>b?(e.selectionStart=C,e.selectionEnd=C):(e.selectionStart=l,e.selectionEnd=Math.min(f,C))}}}),(We&&e.defaultValue!==e.value||Ba(t)==null&&e.value)&&(a(cr(e)?ur(e.value):e.value),mt!==null&&i.add(mt)),za(()=>{var u=t();if(e===document.activeElement){var c=Kr??mt;if(i.has(c))return}cr(e)&&u===ur(e.value)||e.type==="date"&&!u&&!e.value||u!==e.value&&(e.value=u??"")})}function cr(e){var t=e.type;return t==="number"||t==="range"}function ur(e){return e===""?null:+e}const as=[{id:"home",type:"home",title:"Library"}],Dt=Re(as),ht=Re("home"),yr=Re(!1);function Yr(){yr.update(e=>!e)}const Zr=Bt([Dt,ht],([e,t])=>e.find(a=>a.id===t));function ss(e){Dt.update(t=>{const a=t.find(u=>u.type==="viewer"&&u.paper?.id===e.id);if(a)return ht.set(a.id),t;const i={id:`pdf-${e.id}-${Date.now()}`,type:"viewer",title:e.title.length>30?e.title.slice(0,30)+"...":e.title,paper:e};return ht.set(i.id),[...t,i]})}function ea(e){Dt.update(t=>{if(e==="home")return t;const a=t.findIndex(u=>u.id===e);if(a===-1)return t;const i=t.filter(u=>u.id!==e);return ht.update(u=>{if(u===e){const c=Math.min(a,i.length-1);return i[c]?.id??"home"}return u}),i})}function ta(){Dt.update(e=>{const t=e.find(i=>i.type==="settings");if(t)return ht.set(t.id),e;const a={id:"settings",type:"settings",title:"Settings"};return ht.set(a.id),[...e,a]})}function ns(e,t){Dt.update(a=>a.map(i=>i.id===e&&i.type==="viewer"?{...i,viewerState:{...i.viewerState,...t}}:i))}const vr=Object.freeze(Object.defineProperty({__proto__:null,activeTab:Zr,activeTabId:ht,closeTab:ea,isChatPanelOpen:yr,openPaper:ss,openSettings:ta,tabs:Dt,toggleChatPanel:Yr,updateViewerState:ns},Symbol.toStringTag,{value:"Module"}));class os{baseUrl;directUploadUrl;constructor(){if(this.baseUrl="/api",typeof window<"u"){const t=window.location.hostname;t!=="localhost"&&t!=="127.0.0.1"?this.directUploadUrl=`http://${t}:8080/api`:this.directUploadUrl="http://127.0.0.1:8080/api"}else this.directUploadUrl="/api"}async request(t,a,i){try{return await(await fetch(`${this.baseUrl}${a}`,{method:t,headers:i?{"Content-Type":"application/json"}:{},body:i?JSON.stringify(i):void 0})).json()}catch(u){return{success:!1,error:{code:"NETWORK_ERROR",message:u instanceof Error?u.message:"Network request failed"}}}}async listPapers(){return this.request("GET","/papers")}async getPaper(t){return this.request("GET",`/papers/${t}`)}async createPaper(t){return this.request("POST","/papers",t)}async updatePaper(t,a){return this.request("PATCH",`/papers/${t}`,a)}async deletePaper(t){return this.request("DELETE",`/papers/${t}`)}async importByDoi(t){return this.request("POST","/papers/import/doi",{doi:t})}async importByArxiv(t){return this.request("POST","/papers/import/arxiv",{arxivId:t})}async listTags(){return this.request("GET","/tags")}async createTag(t,a){return this.request("POST","/tags",{name:t,color:a})}async assignTags(t,a){return this.request("POST",`/papers/${t}/tags`,{tags:a})}async sendMessage(t,a,i){return this.request("POST","/chat/message",{message:t,paperId:a,sessionId:i})}async getChatSessions(t){const a=t?`?paperId=${t}`:"";return this.request("GET",`/chat/sessions${a}`)}async getChatHistory(t){return this.request("GET",`/chat/sessions/${t}/messages`)}async search(t,a){return this.request("POST","/search",{query:t,...a})}async getSuggestions(t){return this.request("GET",`/search/suggest?q=${encodeURIComponent(t)}`)}async getSettings(){return this.request("GET","/settings")}async updateSettings(t){return this.request("PUT","/settings",t)}async uploadPdf(t,a,i){const u=new FormData;u.append("file",t),a&&u.append("title",a),i&&u.append("skipAnalysis","true");try{return console.log(`Uploading to: ${this.directUploadUrl}/upload/pdf`),await(await fetch(`${this.directUploadUrl}/upload/pdf`,{method:"POST",body:u})).json()}catch(c){return console.error("Upload fetch error:",c),{success:!1,error:{code:"UPLOAD_ERROR",message:c instanceof Error?c.message:"Upload failed"}}}}async confirmMetadata(t){try{return await(await fetch(`${this.directUploadUrl}/upload/confirm`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json()}catch(a){return{success:!1,error:{code:"CONFIRM_ERROR",message:a instanceof Error?a.message:"Failed to confirm metadata"}}}}async uploadPdfForPaper(t,a){const i=new FormData;i.append("file",a);try{return await(await fetch(`${this.directUploadUrl}/upload/pdf/${t}`,{method:"POST",body:i})).json()}catch(u){return{success:!1,error:{code:"UPLOAD_ERROR",message:u instanceof Error?u.message:"Upload failed"}}}}async reanalyzePaper(t){try{return await(await fetch(`${this.directUploadUrl}/upload/reanalyze/${t}`,{method:"POST"})).json()}catch(a){return{success:!1,error:{code:"REANALYZE_ERROR",message:a instanceof Error?a.message:"Failed to re-analyze paper"}}}}async autoTagPaper(t){return this.request("POST",`/papers/${t}/tags/auto`)}async suggestTags(t){return this.request("POST",`/papers/${t}/tags/suggest`)}async mergeSimilarTags(){return this.request("POST","/tags/merge")}async searchOnline(t,a="semantic"){return this.request("GET",`/search/online?q=${encodeURIComponent(t)}&engine=${a}`)}async getLLMLogs(t=50,a){const i=new URLSearchParams({limit:t.toString()});return a&&i.append("purpose",a),this.request("GET",`/llm/logs?${i}`)}async getLLMLogDetail(t){return this.request("GET",`/llm/logs/${t}`)}async getLLMStats(){return this.request("GET","/llm/stats")}async getLLMStatus(){return this.request("GET","/llm/status")}async clearLLMLogs(){return this.request("DELETE","/llm/logs")}}const xe=new os,St=Re([]),is=Re([]),ye=Re(!1),Ue=Re(null),er=Re(null),_r=Re(""),ls=Re(null),ds=Re(null),cs=Re([]),Wt=Re("grid"),us=Re("recent"),hr=Re([]),Yt=Re(!1);let pr=null;const vs=Bt([St,_r,ls,ds,cs,us],([e,t,a,i,u,c])=>{let l=e;if(t){const f=t.toLowerCase();l=l.filter(b=>b.title.toLowerCase().includes(f)||b.authors.some(C=>C.toLowerCase().includes(f))||b.abstract?.toLowerCase().includes(f))}switch(a&&(l=l.filter(f=>f.conference===a)),i&&(l=l.filter(f=>f.year===i)),u.length>0&&(l=l.filter(f=>u.some(b=>f.subject.includes(b)))),c){case"citations":l=[...l].sort((f,b)=>b.citations-f.citations);break;case"title":l=[...l].sort((f,b)=>f.title.localeCompare(b.title));break;case"recent":default:l=[...l].sort((f,b)=>(b.year??0)-(f.year??0));break}return l});Bt(St,e=>{const t=new Map;return e.forEach(a=>{a.conference&&t.set(a.conference,(t.get(a.conference)??0)+1)}),Array.from(t.entries()).map(([a,i])=>({name:a,count:i})).sort((a,i)=>i.count-a.count)});Bt(St,e=>{const t=new Map;return e.forEach(a=>{a.year&&t.set(a.year,(t.get(a.year)??0)+1)}),Array.from(t.entries()).map(([a,i])=>({year:a,count:i})).sort((a,i)=>i.year-a.year)});Bt(St,e=>{const t=new Map;return e.forEach(a=>{a.subject.forEach(i=>{t.set(i,(t.get(i)??0)+1)})}),Array.from(t.entries()).map(([a,i])=>({name:a,count:i})).sort((a,i)=>i.count-a.count)});async function ps(e,t){if(pr&&clearTimeout(pr),e.length<3||t>=3){hr.set([]),Yt.set(!1);return}pr=setTimeout(async()=>{Yt.set(!0);const a=await bs(e);hr.set(a),Yt.set(!1)},500)}async function kt(){ye.set(!0),Ue.set(null);const e=await xe.listPapers();e.success&&e.data?St.set(e.data):Ue.set(e.error?.message??"Failed to load papers"),ye.set(!1)}async function ra(){const e=await xe.listTags();e.success&&e.data&&is.set(e.data)}async function fs(e){ye.set(!0),Ue.set(null);const t=await xe.importByDoi(e);return t.success&&t.data?(St.update(a=>[...a,t.data]),ye.set(!1),t.data):(Ue.set(t.error?.message??"Failed to import paper"),ye.set(!1),null)}async function gs(e){ye.set(!0),Ue.set(null);const t=await xe.importByArxiv(e);return t.success&&t.data?(St.update(a=>[...a,t.data]),ye.set(!1),t.data):(Ue.set(t.error?.message??"Failed to import paper"),ye.set(!1),null)}async function ms(e){const t=await xe.deletePaper(e);return t.success?(St.update(a=>a.filter(i=>i.id!==e)),!0):(Ue.set(t.error?.message??"Failed to delete paper"),!1)}function Ur(){er.set(null)}async function Or(e){ye.set(!0),Ue.set(null);let t=0,a=null;const i=[],u=Array.from(e).filter(c=>c.type==="application/pdf"||c.name.toLowerCase().endsWith(".pdf"));console.log(`Uploading ${u.length} PDF files...`);for(const c of u){console.log(`Uploading: ${c.name} (${Math.round(c.size/1024)}KB)`);try{const l=await xe.uploadPdf(c);console.log("Upload result:",l),l.success&&l.data?(t++,l.data.needsUserConfirmation&&l.data.searchResults.length>0&&i.push({paperId:l.data.paperId,searchQuery:l.data.pdfMetadataTitle||l.data.title,searchResults:l.data.searchResults})):(a=l.error?.message??"Upload failed",console.error("Upload error:",a))}catch(l){a=l instanceof Error?l.message:"Upload failed",console.error("Upload exception:",l)}}return t>0&&await kt(),i.length>0&&er.set(i[0]),a&&t===0&&Ue.set(a),ye.set(!1),{successCount:t,pendingAnalyses:i}}async function _s(){await Promise.all([kt(),ra()])}async function hs(e){ye.set(!0),Ue.set(null);const t=await xe.reanalyzePaper(e);if(t.success&&t.data){const a=t.data;return a.needsUserConfirmation&&a.searchResults.length>0&&er.set({paperId:a.paperId,searchQuery:a.pdfMetadataTitle||a.title,searchResults:a.searchResults}),await kt(),ye.set(!1),a}else return Ue.set(t.error?.message??"Failed to re-analyze paper"),ye.set(!1),null}async function xs(e){ye.set(!0),Ue.set(null);const t=await xe.autoTagPaper(e);return t.success&&t.data?(await ra(),await kt(),ye.set(!1),t.data):(Ue.set(t.error?.message??"Failed to auto-tag paper"),ye.set(!1),null)}async function bs(e,t="semantic"){const a=await xe.searchOnline(e,t);return a.success&&a.data?a.data:[]}async function ys(e){if(ye.set(!0),Ue.set(null),e.doi){const a=await xe.importByDoi(e.doi);if(a.success&&a.data)return await kt(),ye.set(!1),a.data}if(e.arxivId){const a=await xe.importByArxiv(e.arxivId);if(a.success&&a.data)return await kt(),ye.set(!1),a.data}const t=await xe.createPaper({title:e.title,authors:e.authors,abstract:e.abstract??void 0,year:e.year??void 0,conference:e.venue??void 0,doi:e.doi??void 0,arxivId:e.arxivId??void 0,citations:e.citationCount??0,pdfUrl:e.pdfUrl??void 0});return t.success&&t.data?(await kt(),ye.set(!1),t.data):(Ue.set(t.error?.message??"Failed to import paper"),ye.set(!1),null)}function ws(){const{subscribe:e,update:t}=Re([]);function a(c){const l=Math.random().toString(36).slice(2),f={...c,id:l};t(C=>[...C,f]);const b=c.duration??5e3;return b>0&&setTimeout(()=>{i(l)},b),l}function i(c){t(l=>l.filter(f=>f.id!==c))}function u(){t(()=>[])}return{subscribe:e,add:a,remove:i,clear:u,success:(c,l)=>a({type:"success",message:c,duration:l}),error:(c,l)=>a({type:"error",message:c,duration:l}),info:(c,l)=>a({type:"info",message:c,duration:l}),warning:(c,l)=>a({type:"warning",message:c,duration:l})}}const Ee=ws();var Cs=v('<p class="line-clamp-1 text-xs text-muted-foreground"> </p>'),Es=v('<button class="rounded p-1.5 text-muted-foreground hover:bg-muted hover:text-foreground" title="Clear chat"><svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"></path></svg></button>'),ks=v('<button class="rounded-lg border px-3 py-2 text-left text-xs transition-colors hover:bg-muted"> </button>'),Ss=v('<div class="flex flex-col items-center justify-center py-8 text-center"><svg class="mb-3 h-12 w-12 text-muted-foreground/50" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M21 11.5a8.38 8.38 0 01-.9 3.8 8.5 8.5 0 01-7.6 4.7 8.38 8.38 0 01-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 01-.9-3.8 8.5 8.5 0 014.7-7.6 8.38 8.38 0 013.8-.9h.5a8.48 8.48 0 018 8v.5z"></path></svg> <p class="mb-4 text-sm text-muted-foreground">Ask questions about this paper</p> <div class="flex flex-col gap-2"></div></div>'),Is=$t('<svg class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"></path></svg>'),Ts=$t('<svg class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>'),Ps=v('<div class="flex items-center gap-1"><span class="h-2 w-2 animate-bounce rounded-full bg-current"></span> <span class="h-2 w-2 animate-bounce rounded-full bg-current" style="animation-delay: 0.1s"></span> <span class="h-2 w-2 animate-bounce rounded-full bg-current" style="animation-delay: 0.2s"></span></div>'),As=v('<p class="whitespace-pre-wrap text-sm"> </p>'),Ms=v("<div><div><!></div> <div><!></div></div>"),Ls=v('<div class="space-y-4"></div>'),Ds=v('<p class="mt-2 text-xs text-muted-foreground">Open a paper to get context-aware answers</p>'),Rs=v('<div class="flex h-full flex-col bg-card"><div class="flex items-center justify-between border-b p-3"><div><h3 class="font-semibold">Chat with Paper</h3> <!></div> <!></div> <div class="flex-1 overflow-auto p-3"><!></div> <div class="border-t p-3"><div class="flex gap-2"><textarea placeholder="Ask a question..." rows="1" class="flex-1 resize-none rounded-md border bg-background px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary disabled:opacity-50"></textarea> <button class="shrink-0 rounded-md bg-primary px-3 py-2 text-sm text-primary-foreground hover:bg-primary/90 disabled:opacity-50"><svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"></path></svg></button></div> <!></div></div>');function $s(e,t){zt(t,!0);let a=se(Zt([])),i=se(""),u=se(!1),c=se(null),l=se(null);gr(()=>{r(a).length>0&&r(l)&&(r(l).scrollTop=r(l).scrollHeight)}),gr(()=>{t.paper&&(y(a,[],!0),y(c,null))});async function f(){const x=r(i).trim();if(!x||r(u))return;y(i,""),y(u,!0);const q={id:crypto.randomUUID(),role:"user",content:x};y(a,[...r(a),q],!0);const ge=crypto.randomUUID();y(a,[...r(a),{id:ge,role:"assistant",content:"",isLoading:!0}],!0);try{const ee=await xe.sendMessage(x,t.paper?.id,r(c)??void 0);ee.success&&ee.data?(y(c,ee.data.sessionId,!0),y(a,r(a).map(ce=>ce.id===ge?{id:ee.data.messageId,role:"assistant",content:ee.data.content}:ce),!0)):(y(a,r(a).filter(ce=>ce.id!==ge),!0),Ee.error(ee.error?.message??"Failed to get response"))}catch{y(a,r(a).filter(ce=>ce.id!==ge),!0),Ee.error("Failed to send message. Is the API key configured in Settings?")}finally{y(u,!1)}}function b(x){x.key==="Enter"&&!x.shiftKey&&(x.preventDefault(),f())}function C(){y(a,[],!0),y(c,null)}const T=Et(()=>t.paper?["What is the main contribution of this paper?","Summarize the methodology used.","What are the key findings?","What are the limitations mentioned?"]:["Ask me anything about research papers."]);var de=Rs(),O=n(de),Y=n(O),re=o(n(Y),2);{var V=x=>{var q=Cs(),ge=n(q,!0);s(q),w(()=>_(ge,t.paper.title)),d(x,q)};m(re,x=>{t.paper&&x(V)})}s(Y);var h=o(Y,2);{var k=x=>{var q=Es();q.__click=C,d(x,q)};m(h,x=>{r(a).length>0&&x(k)})}s(O);var A=o(O,2),U=n(A);{var R=x=>{var q=Ss(),ge=o(n(q),4);it(ge,21,()=>r(T).slice(0,3),Rt,(ee,ce)=>{var Me=ks();Me.__click=()=>{y(i,r(ce),!0),f()};var S=n(Me,!0);s(Me),w(()=>_(S,r(ce))),d(ee,Me)}),s(ge),s(q),d(x,q)},I=x=>{var q=Ls();it(q,21,()=>r(a),ge=>ge.id,(ge,ee)=>{var ce=Ms(),Me=n(ce),S=n(Me);{var $=P=>{var D=Is();d(P,D)},Z=P=>{var D=Ts();d(P,D)};m(S,P=>{r(ee).role==="user"?P($):P(Z,!1)})}s(Me);var ue=o(Me,2),Se=n(ue);{var ne=P=>{var D=Ps();d(P,D)},M=P=>{var D=As(),me=n(D,!0);s(D),w(()=>_(me,r(ee).content)),d(P,D)};m(Se,P=>{r(ee).isLoading?P(ne):P(M,!1)})}s(ue),s(ce),w(()=>{fe(ce,1,`flex gap-3 ${r(ee).role==="user"?"flex-row-reverse":""}`),fe(Me,1,`flex h-8 w-8 shrink-0 items-center justify-center rounded-full ${r(ee).role==="user"?"bg-primary text-primary-foreground":"bg-muted"}`),fe(ue,1,`max-w-[85%] rounded-lg px-3 py-2 ${r(ee).role==="user"?"bg-primary text-primary-foreground":"bg-muted"}`)}),d(ge,ce)}),s(q),d(x,q)};m(U,x=>{r(a).length===0?x(R):x(I,!1)})}s(A),Fr(A,x=>y(l,x),()=>r(l));var H=o(A,2),z=n(H),G=n(z);Ga(G),G.__keydown=b;var Q=o(G,2);Q.__click=f,s(z);var j=o(z,2);{var K=x=>{var q=Ds();d(x,q)};m(j,x=>{t.paper||x(K)})}s(H),s(de),w(x=>{G.disabled=r(u),Q.disabled=x},[()=>r(u)||!r(i).trim()]),Qt(G,()=>r(i),x=>y(i,x)),d(e,de),Gt()}qt(["click","keydown"]);var Ns=v('<p class="py-8 text-center text-muted-foreground">No matching papers found</p>'),Us=v('<span class="mx-1">Â·</span> ',1),Os=v('<span class="mt-2 inline-block rounded bg-muted px-2 py-0.5 text-xs"> </span>'),Vs=v('<span class="text-primary">DOI</span>'),Fs=v('<span class="text-green-600">PDF Available</span>'),Bs=v('<p class="mt-2 line-clamp-2 text-xs text-muted-foreground"> </p>'),zs=v('<button><h3 class="line-clamp-2 font-medium"> </h3> <p class="mt-1 text-sm text-muted-foreground"> <!></p> <!> <div class="mt-2 flex items-center gap-4 text-xs text-muted-foreground"><span> </span> <!> <!></div> <!></button>'),Gs=v('<div class="space-y-3"></div>'),qs=v('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50" role="dialog" aria-modal="true"><div class="flex max-h-[80vh] w-full max-w-2xl flex-col overflow-hidden rounded-lg bg-background shadow-xl"><div class="border-b p-4"><h2 class="text-lg font-semibold">Select Matching Paper</h2> <p class="mt-1 text-sm text-muted-foreground">We found similar papers for: "<span class="font-medium"> </span>"</p></div> <div class="flex-1 overflow-auto p-4"><!></div> <div class="flex justify-end gap-2 border-t p-4"><button class="rounded-md px-4 py-2 text-sm hover:bg-muted">Skip (Keep current info)</button></div></div></div>');function Hs(e,t){zt(t,!0);let a=se(!1),i=se(null);async function u(A){y(a,!0),y(i,A,!0);const U={paperId:t.paperId,title:A.title,authors:A.authors,abstract:A.abstract??void 0,doi:A.doi??void 0,arxivId:A.arxivId??void 0,year:A.year??void 0,venue:A.venue??void 0,citationsCount:A.citationCount??void 0},R=await xe.confirmMetadata(U);R.success?(Ee.success("Paper metadata updated"),t.onConfirm()):Ee.error(R.error?.message??"Failed to update metadata"),y(a,!1)}function c(){Ee.info("Paper saved without additional metadata"),t.onCancel()}var l=qs(),f=n(l),b=n(f),C=o(n(b),2),T=o(n(C)),de=n(T,!0);s(T),Ot(),s(C),s(b);var O=o(b,2),Y=n(O);{var re=A=>{var U=Ns();d(A,U)},V=A=>{var U=Gs();it(U,21,()=>t.results,Rt,(R,I)=>{var H=zs();H.__click=()=>u(r(I));var z=n(H),G=n(z,!0);s(z);var Q=o(z,2),j=n(Q),K=o(j);{var x=M=>{var P=Us(),D=o(qe(P));w(()=>_(D,` ${r(I).year??""}`)),d(M,P)};m(K,M=>{r(I).year&&M(x)})}s(Q);var q=o(Q,2);{var ge=M=>{var P=Os(),D=n(P,!0);s(P),w(()=>_(D,r(I).venue)),d(M,P)};m(q,M=>{r(I).venue&&M(ge)})}var ee=o(q,2),ce=n(ee),Me=n(ce);s(ce);var S=o(ce,2);{var $=M=>{var P=Vs();d(M,P)};m(S,M=>{r(I).doi&&M($)})}var Z=o(S,2);{var ue=M=>{var P=Fs();d(M,P)};m(Z,M=>{r(I).pdfUrl&&M(ue)})}s(ee);var Se=o(ee,2);{var ne=M=>{var P=Bs(),D=n(P,!0);s(P),w(()=>_(D,r(I).abstract)),d(M,P)};m(Se,M=>{r(I).abstract&&M(ne)})}s(H),w(M=>{fe(H,1,`w-full rounded-lg border p-4 text-left transition-colors hover:bg-muted disabled:opacity-50 ${r(i)?.id===r(I).id?"border-primary bg-primary/5":""}`),H.disabled=r(a),_(G,r(I).title),_(j,`${M??""}${r(I).authors.length>3?" et al.":""} `),_(Me,`${r(I).citationCount??0??""} citations`)},[()=>r(I).authors.slice(0,3).join(", ")]),d(R,H)}),s(U),d(A,U)};m(Y,A=>{t.results.length===0?A(re):A(V,!1)})}s(O);var h=o(O,2),k=n(h);k.__click=c,s(h),s(f),s(l),w(()=>{_(de,t.searchQuery),k.disabled=r(a)}),d(e,l),Gt()}qt(["click"]);var js=v('<div class="h-4 w-4 animate-spin rounded-full border-2 border-primary border-t-transparent"></div> <span class="text-sm font-medium"> </span>',1),Ks=v('<svg class="h-4 w-4 text-green-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"></polyline></svg> <span class="text-sm font-medium"> </span>',1),Js=v('<button class="flex items-center gap-2 rounded-lg bg-background border shadow-lg px-3 py-2 hover:bg-muted transition-colors"><!></button>'),Ws=v('<div class="h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"></div>'),Xs=$t('<svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"></polyline></svg>'),Qs=$t('<svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>'),Ys=$t('<svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>'),Zs=v('<p class="text-xs text-muted-foreground truncate"> </p>'),en=v('<p class="text-xs text-destructive truncate"> </p>'),tn=v('<div class="mt-2 h-1 rounded-full bg-muted overflow-hidden"><div class="h-full bg-primary transition-all duration-300"></div></div>'),rn=v('<div class="border-b last:border-b-0 px-3 py-2"><div class="flex items-start gap-2"><div><!></div> <div class="flex-1 min-w-0"><div class="flex items-center gap-2"><span class="text-xs text-muted-foreground"> </span></div> <p class="text-sm font-medium truncate"> </p> <!> <!></div></div> <!></div>'),an=v('<div class="border-t px-3 py-2 bg-muted/30"><button class="text-xs text-muted-foreground hover:text-foreground">Clear completed</button></div>'),sn=v('<div class="w-80 rounded-lg bg-background border shadow-xl overflow-hidden"><div class="flex items-center justify-between border-b px-3 py-2 bg-muted/30"><span class="text-sm font-medium">Background Tasks</span> <button class="rounded p-1 hover:bg-muted"><svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="18 15 12 9 6 15"></polyline></svg></button></div> <div class="max-h-64 overflow-auto"></div> <!></div>'),nn=v('<div class="fixed bottom-4 right-4 z-40 flex flex-col items-end gap-2"><!></div>');function on(e,t){zt(t,!0);let a=se(Zt([])),i=se(!1),u=null,c=Et(()=>r(a).filter(V=>V.status==="PENDING"||V.status==="RUNNING")),l=Et(()=>r(a).filter(V=>{if(V.status!=="COMPLETED"&&V.status!=="FAILED"||!V.completedAt)return!1;const h=new Date(V.completedAt).getTime();return Date.now()-h<3e4})),f=Et(()=>[...r(c),...r(l)]),b=Et(()=>r(f).length>0);async function C(){const V=await xe.request("GET","/jobs/active");V.success&&V.data&&y(a,V.data,!0)}function T(V){switch(V){case"PENDING":return"text-muted-foreground";case"RUNNING":return"text-primary";case"COMPLETED":return"text-green-500";case"FAILED":return"text-destructive";case"CANCELLED":return"text-muted-foreground";default:return"text-muted-foreground"}}function de(V){switch(V){case"PDF_ANALYSIS":return"PDF Analysis";case"AUTO_TAGGING":return"Auto Tagging";case"METADATA_LOOKUP":return"Metadata Lookup";case"TAG_MERGE":return"Tag Merge";case"BULK_IMPORT":return"Bulk Import";default:return V}}xr(()=>{C(),u=setInterval(C,2e3)}),pa(()=>{u&&clearInterval(u)});var O=vt(),Y=qe(O);{var re=V=>{var h=nn(),k=n(h);{var A=R=>{var I=Js();I.__click=()=>y(i,!0);var H=n(I);{var z=Q=>{var j=js(),K=o(qe(j),2),x=n(K);s(K),w(()=>_(x,`${r(c).length??""} task${r(c).length>1?"s":""} running`)),d(Q,j)},G=Q=>{var j=Ks(),K=o(qe(j),2),x=n(K);s(K),w(()=>_(x,`${r(l).length??""} completed`)),d(Q,j)};m(H,Q=>{r(c).length>0?Q(z):Q(G,!1)})}s(I),d(R,I)},U=R=>{var I=sn(),H=n(I),z=o(n(H),2);z.__click=()=>y(i,!1),s(H);var G=o(H,2);it(G,21,()=>r(f),K=>K.id,(K,x)=>{var q=rn(),ge=n(q),ee=n(ge),ce=n(ee);{var Me=te=>{var ve=Ws();d(te,ve)},S=te=>{var ve=vt(),Le=qe(ve);{var lt=Ve=>{var Fe=Xs();d(Ve,Fe)},dt=Ve=>{var Fe=vt(),pt=qe(Fe);{var rt=He=>{var Ye=Qs();d(He,Ye)},Qe=He=>{var Ye=Ys();d(He,Ye)};m(pt,He=>{r(x).status==="FAILED"?He(rt):He(Qe,!1)},!0)}d(Ve,Fe)};m(Le,Ve=>{r(x).status==="COMPLETED"?Ve(lt):Ve(dt,!1)},!0)}d(te,ve)};m(ce,te=>{r(x).status==="RUNNING"?te(Me):te(S,!1)})}s(ee);var $=o(ee,2),Z=n($),ue=n(Z),Se=n(ue,!0);s(ue),s(Z);var ne=o(Z,2),M=n(ne,!0);s(ne);var P=o(ne,2);{var D=te=>{var ve=Zs(),Le=n(ve,!0);s(ve),w(()=>_(Le,r(x).progressMessage)),d(te,ve)};m(P,te=>{r(x).progressMessage&&te(D)})}var me=o(P,2);{var $e=te=>{var ve=en(),Le=n(ve,!0);s(ve),w(()=>_(Le,r(x).error)),d(te,ve)};m(me,te=>{r(x).error&&te($e)})}s($),s(ge);var Oe=o(ge,2);{var Xe=te=>{var ve=tn(),Le=n(ve);s(ve),w(()=>Qa(Le,`width: ${r(x).progress??""}%`)),d(te,ve)};m(Oe,te=>{r(x).status==="RUNNING"&&r(x).progress>0&&te(Xe)})}s(q),w((te,ve)=>{fe(ee,1,`shrink-0 mt-0.5 ${te??""}`),_(Se,ve),_(M,r(x).title)},[()=>T(r(x).status),()=>de(r(x).type)]),d(K,q)}),s(G);var Q=o(G,2);{var j=K=>{var x=an(),q=n(x);q.__click=async()=>{await xe.request("DELETE","/jobs/completed"),C()},s(x),d(K,x)};m(Q,K=>{r(l).length>0&&K(j)})}s(I),d(R,I)};m(k,R=>{r(i)?R(U,!1):R(A)})}s(h),d(V,h)};m(Y,V=>{r(b)&&V(re)})}d(e,O),Gt()}qt(["click"]);var ln=v("<option> </option>"),dn=v('<span class="ml-auto"> </span>'),cn=v('<div class="flex items-center gap-4 border-b bg-muted/30 px-4 py-2 text-xs"><span class="flex items-center gap-1"><span></span> </span> <span>Provider: <strong> </strong></span> <!></div>'),un=v('<div class="flex items-center justify-center py-12"><div class="h-6 w-6 animate-spin rounded-full border-2 border-primary border-t-transparent"></div></div>'),vn=v('<div class="flex flex-col items-center justify-center py-12 text-muted-foreground"><svg class="mb-2 h-12 w-12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <p>No LLM calls yet</p> <p class="text-xs">LLM usage will appear here</p></div>'),pn=v('<span class="rounded bg-destructive/10 px-1.5 py-0.5 text-xs text-destructive">failed</span>'),fn=v("<span> </span>"),gn=v('<span class="truncate"> </span>'),mn=v('<button><div class="flex items-center gap-2"><span> </span> <span class="text-xs text-muted-foreground"> </span> <span class="ml-auto text-xs text-muted-foreground"> </span> <!></div> <p class="mt-1 truncate text-sm"> </p> <div class="mt-1 flex items-center gap-3 text-xs text-muted-foreground"><span> </span> <!> <span> </span> <!></div></button>'),_n=v('<div class="divide-y"></div>'),hn=v('<div><span class="text-xs text-muted-foreground">Related Paper</span> <p class="text-sm"> </p></div>'),xn=v('<div><span class="text-xs text-muted-foreground">Error</span> <p class="rounded bg-destructive/10 p-2 text-sm text-destructive"> </p></div>'),bn=v('<div><span class="text-xs text-muted-foreground">Output Response</span> <pre class="mt-1 max-h-48 overflow-auto rounded bg-muted p-2 text-xs whitespace-pre-wrap"> </pre></div>'),yn=v('<div class="w-96 border-l overflow-auto"><div class="sticky top-0 flex items-center justify-between border-b bg-background px-4 py-2"><h3 class="font-medium">Log Detail</h3> <button class="rounded p-1 hover:bg-muted" title="Close detail panel"><svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"></path></svg></button></div> <div class="p-4 space-y-4"><div class="grid grid-cols-2 gap-2 text-sm"><div><span class="text-xs text-muted-foreground">Purpose</span> <p class="font-medium"> </p></div> <div><span class="text-xs text-muted-foreground">Provider</span> <p class="font-medium"> </p></div> <div><span class="text-xs text-muted-foreground">Duration</span> <p class="font-medium"> </p></div> <div><span class="text-xs text-muted-foreground">Status</span> <p> </p></div> <div><span class="text-xs text-muted-foreground">Input tokens</span> <p class="font-medium"> </p></div> <div><span class="text-xs text-muted-foreground">Output tokens</span> <p class="font-medium"> </p></div></div> <!> <!> <div><span class="text-xs text-muted-foreground">Input Prompt</span> <pre class="mt-1 max-h-48 overflow-auto rounded bg-muted p-2 text-xs whitespace-pre-wrap"> </pre></div> <!></div></div>'),wn=v('<div class="flex h-full flex-col"><div class="flex items-center justify-between border-b px-4 py-3"><h2 class="text-lg font-semibold">LLM Usage Log</h2> <div class="flex items-center gap-2"><select class="rounded-md border bg-background px-2 py-1 text-sm"><option>All purposes</option><!></select> <button class="rounded p-1.5 text-muted-foreground hover:bg-muted" title="Refresh"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 4v6h6M23 20v-6h-6"></path><path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"></path></svg></button> <button class="rounded p-1.5 text-muted-foreground hover:bg-destructive hover:text-destructive-foreground" title="Clear logs"><svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"></path></svg></button></div></div> <!> <div class="flex flex-1 overflow-hidden"><div class="flex-1 overflow-auto"><!></div> <!></div></div>');function Cn(e,t){zt(t,!0);let a=se(Zt([])),i=se(null),u=se(null),c=se(!0),l=se(null),f=se(""),b=se(!1);xr(()=>{C();const S=setInterval(()=>{r(l)||C(!0)},1e4);return()=>clearInterval(S)});async function C(S=!1){S||y(c,!0),y(b,!0);const[$,Z,ue]=await Promise.all([xe.getLLMLogs(50,r(f)||void 0),xe.getLLMStats(),xe.getLLMStatus()]);$.success&&$.data&&y(a,$.data,!0),Z.success&&Z.data&&y(i,Z.data,!0),ue.success&&ue.data&&y(u,ue.data,!0),y(c,!1),y(b,!1)}async function T(S){const $=await xe.getLLMLogDetail(S);$.success&&$.data&&y(l,$.data,!0)}async function de(){confirm("Clear all LLM logs? This cannot be undone.")&&(await xe.clearLLMLogs(),await C())}function O(S){return new Date(S).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}function Y(S){return new Date(S).toLocaleDateString("en-US",{month:"short",day:"numeric"})}function re(S){return{chat:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",title_cleaning:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",author_cleaning:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200",auto_tag:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",summarize:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200"}[S]||"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"}const V=["","chat","title_cleaning","author_cleaning","auto_tag","summarize"];var h=wn(),k=n(h),A=o(n(k),2),U=n(A);U.__change=()=>C();var R=n(U);R.value=R.__value="";var I=o(R);it(I,17,()=>V.slice(1),Rt,(S,$)=>{var Z=ln(),ue=n(Z,!0);s(Z);var Se={};w(ne=>{_(ue,ne),Se!==(Se=r($))&&(Z.value=(Z.__value=r($))??"")},[()=>r($).replace("_"," ")]),d(S,Z)}),s(U);var H=o(U,2);H.__click=()=>C();var z=n(H);s(H);var G=o(H,2);G.__click=de,s(A),s(k);var Q=o(k,2);{var j=S=>{var $=cn(),Z=n($),ue=n(Z),Se=o(ue);s(Z);var ne=o(Z,2),M=o(n(ne)),P=n(M,!0);s(M),s(ne);var D=o(ne,2);{var me=$e=>{var Oe=dn(),Xe=n(Oe);s(Oe),w(()=>_(Xe,`${r(i).totalCalls??""} calls | ${r(i).successfulCalls??""} success | ~${r(i).totalInputTokensEstimate+r(i).totalOutputTokensEstimate} tokens`)),d($e,Oe)};m(D,$e=>{r(i)&&$e(me)})}s($),w(()=>{fe(ue,1,`h-2 w-2 rounded-full ${r(u).configured?"bg-green-500":"bg-yellow-500"}`),_(Se,` ${r(u).configured?"Configured":"Not configured"}`),_(P,r(u).provider)}),d(S,$)};m(Q,S=>{r(u)&&S(j)})}var K=o(Q,2),x=n(K),q=n(x);{var ge=S=>{var $=un();d(S,$)},ee=S=>{var $=vt(),Z=qe($);{var ue=ne=>{var M=vn();d(ne,M)},Se=ne=>{var M=_n();it(M,21,()=>r(a),Rt,(P,D)=>{var me=mn();me.__click=()=>T(r(D).id);var $e=n(me),Oe=n($e),Xe=n(Oe,!0);s(Oe);var te=o(Oe,2),ve=n(te,!0);s(te);var Le=o(te,2),lt=n(Le);s(Le);var dt=o(Le,2);{var Ve=Ie=>{var De=pn();d(Ie,De)};m(dt,Ie=>{r(D).success||Ie(Ve)})}s($e);var Fe=o($e,2),pt=n(Fe,!0);s(Fe);var rt=o(Fe,2),Qe=n(rt),He=n(Qe);s(Qe);var Ye=o(Qe,2);{var Nt=Ie=>{var De=fn(),ct=n(De);s(De),w(()=>_(ct,`~${r(D).outputTokensEstimate??""} out`)),d(Ie,De)};m(Ye,Ie=>{r(D).outputTokensEstimate&&Ie(Nt)})}var xt=o(Ye,2),Ut=n(xt);s(xt);var It=o(xt,2);{var Tt=Ie=>{var De=gn(),ct=n(De);s(De),w(()=>_(ct,`Paper: ${r(D).paperTitle??""}`)),d(Ie,De)};m(It,Ie=>{r(D).paperTitle&&Ie(Tt)})}s(rt),s(me),w((Ie,De,ct,Te)=>{fe(me,1,`w-full px-4 py-2 text-left hover:bg-muted/50 transition-colors ${r(l)?.id===r(D).id?"bg-muted":""}`),fe(Oe,1,`rounded px-1.5 py-0.5 text-xs font-medium ${Ie??""}`),_(Xe,De),_(ve,r(D).provider),_(lt,`${ct??""} ${Te??""}`),_(pt,r(D).inputPromptPreview),_(He,`~${r(D).inputTokensEstimate??""} in`),_(Ut,`${r(D).durationMs??""}ms`)},[()=>re(r(D).purpose),()=>r(D).purpose.replace("_"," "),()=>Y(r(D).timestamp),()=>O(r(D).timestamp)]),d(P,me)}),s(M),d(ne,M)};m(Z,ne=>{r(a).length===0?ne(ue):ne(Se,!1)},!0)}d(S,$)};m(q,S=>{r(c)?S(ge):S(ee,!1)})}s(x);var ce=o(x,2);{var Me=S=>{var $=yn(),Z=n($),ue=o(n(Z),2);ue.__click=()=>y(l,null),s(Z);var Se=o(Z,2),ne=n(Se),M=n(ne),P=o(n(M),2),D=n(P,!0);s(P),s(M);var me=o(M,2),$e=o(n(me),2),Oe=n($e,!0);s($e),s(me);var Xe=o(me,2),te=o(n(Xe),2),ve=n(te);s(te),s(Xe);var Le=o(Xe,2),lt=o(n(Le),2),dt=n(lt,!0);s(lt),s(Le);var Ve=o(Le,2),Fe=o(n(Ve),2),pt=n(Fe);s(Fe),s(Ve);var rt=o(Ve,2),Qe=o(n(rt),2),He=n(Qe);s(Qe),s(rt),s(ne);var Ye=o(ne,2);{var Nt=Te=>{var Ne=hn(),ut=o(n(Ne),2),Pt=n(ut,!0);s(ut),s(Ne),w(()=>_(Pt,r(l).paperTitle)),d(Te,Ne)};m(Ye,Te=>{r(l).paperTitle&&Te(Nt)})}var xt=o(Ye,2);{var Ut=Te=>{var Ne=xn(),ut=o(n(Ne),2),Pt=n(ut,!0);s(ut),s(Ne),w(()=>_(Pt,r(l).errorMessage)),d(Te,Ne)};m(xt,Te=>{r(l).errorMessage&&Te(Ut)})}var It=o(xt,2),Tt=o(n(It),2),Ie=n(Tt,!0);s(Tt),s(It);var De=o(It,2);{var ct=Te=>{var Ne=bn(),ut=o(n(Ne),2),Pt=n(ut,!0);s(ut),s(Ne),w(()=>_(Pt,r(l).outputResponse)),d(Te,Ne)};m(De,Te=>{r(l).outputResponse&&Te(ct)})}s(Se),s($),w(Te=>{_(D,Te),_(Oe,r(l).provider),_(ve,`${r(l).durationMs??""}ms`),fe(lt,1,`font-medium ${r(l).success?"text-green-600":"text-destructive"}`),_(dt,r(l).success?"Success":"Failed"),_(pt,`~${r(l).inputTokensEstimate??""}`),_(He,`~${r(l).outputTokensEstimate??0??""}`),_(Ie,r(l).inputPrompt)},[()=>r(l).purpose.replace("_"," ")]),d(S,$)};m(ce,S=>{r(l)&&S(Me)})}s(K),s(h),w(()=>{H.disabled=r(b),fe(z,0,`h-4 w-4 ${r(b)?"animate-spin":""}`)}),Xr(U,()=>r(f),S=>y(f,S)),d(e,h),Gt()}qt(["change","click"]);const En={"IEEE Transactions on Pattern Analysis and Machine Intelligence":"TPAMI","IEEE Transactions on Image Processing":"TIP","IEEE Transactions on Neural Networks and Learning Systems":"TNNLS","IEEE Transactions on Intelligent Transportation Systems":"TITS","IEEE Transactions on Knowledge and Data Engineering":"TKDE","IEEE Transactions on Visualization and Computer Graphics":"TVCG","IEEE Transactions on Information Forensics and Security":"TIFS","IEEE Transactions on Multimedia":"TMM","IEEE Transactions on Cybernetics":"TCYB","IEEE Transactions on Medical Imaging":"TMI","IEEE Transactions on Signal Processing":"TSP","IEEE Transactions on Circuits and Systems for Video Technology":"TCSVT","IEEE Transactions on Automatic Control":"TAC","IEEE Transactions on Robotics":"TRO","IEEE Transactions on Software Engineering":"TSE","IEEE Transactions on Parallel and Distributed Systems":"TPDS","IEEE Transactions on Geoscience and Remote Sensing":"TGRS","IEEE Transactions on Industrial Electronics":"TIE","IEEE Transactions on Wireless Communications":"TWC","IEEE Transactions on Communications":"TCOM","Conference on Computer Vision and Pattern Recognition":"CVPR","IEEE Conference on Computer Vision and Pattern Recognition":"CVPR","IEEE/CVF Conference on Computer Vision and Pattern Recognition":"CVPR","International Conference on Computer Vision":"ICCV","IEEE International Conference on Computer Vision":"ICCV","IEEE/CVF International Conference on Computer Vision":"ICCV","European Conference on Computer Vision":"ECCV","Neural Information Processing Systems":"NeurIPS","Advances in Neural Information Processing Systems":"NeurIPS","Conference on Neural Information Processing Systems":"NeurIPS","International Conference on Machine Learning":"ICML","International Conference on Learning Representations":"ICLR","AAAI Conference on Artificial Intelligence":"AAAI","International Joint Conference on Artificial Intelligence":"IJCAI","Annual Meeting of the Association for Computational Linguistics":"ACL","Conference on Empirical Methods in Natural Language Processing":"EMNLP","North American Chapter of the Association for Computational Linguistics":"NAACL","USENIX Symposium on Operating Systems Design and Implementation":"OSDI","ACM Symposium on Operating Systems Principles":"SOSP","ACM SIGCOMM Conference":"SIGCOMM","USENIX Annual Technical Conference":"USENIX ATC","ACM SIGMOD International Conference on Management of Data":"SIGMOD","International Conference on Very Large Data Bases":"VLDB","ACM SIGKDD Conference on Knowledge Discovery and Data Mining":"KDD","IEEE International Conference on Data Engineering":"ICDE","ACM Conference on Human Factors in Computing Systems":"CHI","ACM Symposium on User Interface Software and Technology":"UIST","ACM SIGGRAPH":"SIGGRAPH","ACM SIGGRAPH Asia":"SIGGRAPH Asia","IEEE International Conference on Robotics and Automation":"ICRA","IEEE/RSJ International Conference on Intelligent Robots and Systems":"IROS","Robotics: Science and Systems":"RSS","Conference on Robot Learning":"CoRL","IEEE Symposium on Security and Privacy":"S&P","USENIX Security Symposium":"USENIX Security","ACM Conference on Computer and Communications Security":"CCS","Network and Distributed System Security Symposium":"NDSS",Nature:"Nature",Science:"Science","Nature Communications":"Nat. Commun.","Nature Machine Intelligence":"Nat. Mach. Intell.","Science Robotics":"Sci. Robot.","Journal of Machine Learning Research":"JMLR","Artificial Intelligence":"AIJ","International Journal of Computer Vision":"IJCV","ACM Computing Surveys":"CSUR","Communications of the ACM":"CACM","arXiv preprint":"arXiv",arXiv:"arXiv"};function Xt(e){return e.toLowerCase().replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim()}function kn(e){if(!e)return null;const t=e.trim();for(const[a,i]of Object.entries(En))if(Xt(a)===Xt(t)||Xt(t).includes(Xt(a)))return i;return t.length<=10&&!t.includes(" ")?t:Sn(t)}function Sn(e){const t=new Set(["on","of","the","and","in","for","to","a","an","with","proceedings","conference","symposium","workshop","journal","transactions","annual","international"]),a={ieee:"IEEE",acm:"ACM",artificial:"Art.",intelligence:"Intell.",computer:"Comp.",computing:"Comp.",computational:"Comp.",learning:"Learn.",machine:"Mach.",neural:"Neur.",network:"Net.",networks:"Net.",vision:"Vis.",visual:"Vis.",pattern:"Patt.",recognition:"Recog.",processing:"Proc.",systems:"Sys.",system:"Sys.",analysis:"Anal.",engineering:"Eng.",science:"Sci.",scientific:"Sci.",data:"Data",database:"DB",information:"Inf.",knowledge:"Know.",language:"Lang.",natural:"Nat.",robotics:"Robot.",automation:"Auto.",graphics:"Graph.",multimedia:"MM",security:"Sec.",software:"Soft.",hardware:"Hardw.",communication:"Comm.",communications:"Comm.",medical:"Med.",image:"Image",imaging:"Imag.",signal:"Sig.",european:"Eur.",american:"Am.",asian:"Asian",pacific:"Pac."},i=e.split(/\s+/),u=[];for(const l of i){const f=l.toLowerCase().replace(/[^a-z0-9]/g,"");t.has(f)||(a[f]?u.push(a[f]):f.length>0&&u.push(f.charAt(0).toUpperCase()))}const c=u.join("");if(c.length<=2||c.length<=4&&!c.includes(".")){const l=i.filter(f=>!t.has(f.toLowerCase().replace(/[^a-z]/g,""))).map(f=>f.charAt(0).toUpperCase()).join("");return l.length>1?l:c}return c}function Vr(e){if(!e)return{display:"",full:null};const t=kn(e);return t&&t!==e?{display:t,full:e}:{display:e,full:null}}var In=v('<div role="button" tabindex="0" aria-label="Drop zone for PDF files"><svg class="mb-2 h-12 w-12 text-muted-foreground" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg> <p class="mb-2 text-sm text-muted-foreground">Drag & drop PDF files here</p> <button class="rounded-md bg-primary px-4 py-2 text-sm text-primary-foreground hover:bg-primary/90">Choose Files</button></div>'),Tn=v('<input type="text" class="mb-4 w-full rounded-md border bg-background px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary"/>'),Pn=v('<p class="mb-4 text-sm text-destructive"> </p>'),An=v('<button class="rounded-md bg-primary px-4 py-2 text-sm text-primary-foreground hover:bg-primary/90 disabled:opacity-50"> </button>'),Mn=v('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50"><div class="w-full max-w-md rounded-lg bg-background p-6 shadow-xl"><h2 class="mb-4 text-lg font-semibold">Add Paper</h2> <div class="mb-4 flex gap-2"><button>PDF File</button> <button>DOI</button> <button>arXiv</button></div> <!> <!> <div class="flex justify-end gap-2"><button class="rounded-md px-4 py-2 text-sm hover:bg-muted">Cancel</button> <!></div></div></div>'),Ln=v('<div class="pointer-events-none fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm"><div class="flex flex-col items-center rounded-2xl border-4 border-dashed border-primary bg-background p-12 shadow-2xl"><svg class="mb-4 h-16 w-16 text-primary animate-bounce" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12"></path></svg> <p class="text-xl font-bold text-foreground">Drop PDF files here</p> <p class="mt-2 text-sm text-muted-foreground">Files will be added to your library</p></div></div>'),Dn=v('<button class="ml-1 rounded p-0.5 hover:bg-muted"><svg class="h-3 w-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"></path></svg></button>'),Rn=v('<button><span class="max-w-32 truncate"> </span> <!></button>'),$n=v('<button><svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg></button>'),Nn=v('<div class="ml-auto"></div>'),Un=v('<div class="flex items-center justify-center py-12"><div class="h-8 w-8 animate-spin rounded-full border-2 border-primary border-t-transparent"></div></div>'),On=v('<div><svg class="mb-4 h-16 w-16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <p class="text-lg font-medium">No papers yet</p> <p class="mt-1 text-sm">Drop PDF files here or click Add Paper to get started</p> <button class="mt-4 rounded-md bg-primary px-4 py-2 text-sm text-primary-foreground hover:bg-primary/90">Add Paper</button></div>'),Vn=v("<span> </span>"),Fn=v('<span class="rounded bg-muted px-2 py-0.5"> </span>'),Bn=v('<span class="ml-auto text-primary">PDF</span>'),zn=v('<span class="ml-auto"> </span>'),Gn=v('<span class="rounded-full bg-primary/10 px-2 py-0.5 text-xs text-primary"> </span>'),qn=v('<div class="mt-2 flex flex-wrap gap-1"></div>'),Hn=v('<div class="group relative cursor-pointer rounded-lg border bg-card p-4 transition-shadow hover:shadow-md"><button class="absolute right-2 top-2 rounded p-1 text-muted-foreground opacity-0 transition-opacity hover:bg-destructive hover:text-destructive-foreground group-hover:opacity-100" title="Delete paper"><svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"></path></svg></button> <h3 class="mb-2 line-clamp-2 pr-6 font-semibold"> </h3> <p class="mb-2 text-sm text-muted-foreground"> </p> <div class="flex items-center gap-2 text-xs text-muted-foreground"><!> <!> <!></div> <!></div>'),jn=v("<span> </span>"),Kn=v('<span class="rounded bg-muted px-2 py-0.5"> </span>'),Jn=v('<span class="text-primary">PDF</span>'),Wn=v("<span> </span>"),Xn=v('<div class="group flex cursor-pointer items-center gap-4 rounded-lg border bg-card p-4 transition-shadow hover:shadow-md"><div class="flex-1 min-w-0"><h3 class="font-semibold truncate"> </h3> <p class="mt-1 text-sm text-muted-foreground truncate"> </p></div> <div class="flex items-center gap-4 text-sm text-muted-foreground shrink-0"><!> <!> <!> <button class="rounded p-1 text-muted-foreground opacity-0 transition-opacity hover:bg-destructive hover:text-destructive-foreground group-hover:opacity-100" title="Delete paper"><svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"></path></svg></button></div></div>'),Qn=$t('<svg class="h-4 w-4 shrink-0 text-primary" viewBox="0 0 24 24" fill="currentColor"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6z"></path></svg>'),Yn=v('<span class="shrink-0 text-muted-foreground"> </span>'),Zn=v('<div class="group flex cursor-pointer items-center gap-2 rounded px-3 py-2 text-sm transition-colors hover:bg-muted"><!> <span class="flex-1 truncate font-medium"> </span> <span class="shrink-0 text-muted-foreground"> </span> <!> <button class="shrink-0 rounded p-0.5 text-muted-foreground opacity-0 transition-opacity hover:bg-destructive hover:text-destructive-foreground group-hover:opacity-100" title="Delete paper"><svg class="h-3.5 w-3.5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"></path></svg></button></div>'),eo=v('<div class="flex items-center gap-2 text-sm text-muted-foreground"><div class="h-4 w-4 animate-spin rounded-full border-2 border-primary border-t-transparent"></div> Searching online...</div>'),to=v("<span> </span>"),ro=v('<span class="rounded bg-muted px-1.5 py-0.5"> </span>'),ao=v("<span> </span>"),so=v('<a target="_blank" rel="noopener noreferrer" class="rounded border px-3 py-1.5 text-xs hover:bg-muted">PDF</a>'),no=v('<div class="rounded-lg border border-dashed border-primary/30 bg-primary/5 p-4"><h3 class="mb-2 line-clamp-2 font-medium text-sm"> </h3> <p class="mb-2 text-xs text-muted-foreground"> </p> <div class="flex items-center gap-2 text-xs text-muted-foreground"><!> <!> <!></div> <div class="mt-3 flex items-center gap-2"><button class="flex-1 rounded bg-primary px-3 py-1.5 text-xs text-primary-foreground hover:bg-primary/90">Add to Library</button> <!></div></div>'),oo=v('<div class="grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-3"></div>'),io=v('<p class="text-sm text-muted-foreground"> </p>'),lo=v('<div class="mt-8"><div class="mb-4 flex items-center justify-between"><h2 class="text-lg font-medium">Available to Download</h2> <!></div> <!></div>'),co=v("<div></div> <!>",1),uo=v('<span class="shrink-0 text-xs text-muted-foreground"> </span>'),vo=v('<div class="flex flex-1 items-center justify-center bg-muted/20"><div class="h-8 w-8 animate-spin rounded-full border-2 border-primary border-t-transparent"></div></div>'),po=v('<p class="mt-4 max-w-2xl text-center text-sm text-muted-foreground"> </p>'),fo=v('<div class="flex flex-1 flex-col items-center justify-center bg-muted/20"><svg class="mb-4 h-16 w-16 text-muted-foreground" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <h2 class="mb-2 text-xl font-semibold"> </h2> <p class="text-muted-foreground">No PDF file attached</p> <!> <button class="mt-4 rounded-md bg-primary px-4 py-2 text-sm text-primary-foreground hover:bg-primary/90">Upload PDF</button></div>'),go=v('<div class="w-80 border-l"><!></div>'),mo=v('<div><div class="flex flex-1 flex-col"><div class="flex items-center justify-between border-b bg-muted/30 px-4 py-2"><div class="flex items-center gap-2 min-w-0 flex-1"><h2 class="truncate text-sm font-medium"> </h2> <!></div> <div class="flex items-center gap-1 shrink-0"><button class="rounded px-2 py-1 text-xs text-muted-foreground hover:bg-muted hover:text-foreground" title="Re-analyze PDF to update metadata"><svg class="h-4 w-4 inline mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 4v6h6M23 20v-6h-6"></path><path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"></path></svg> Re-analyze</button> <button class="rounded px-2 py-1 text-xs text-muted-foreground hover:bg-muted hover:text-foreground" title="Auto-generate tags using AI"><svg class="h-4 w-4 inline mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg> Auto-tag</button></div></div> <!></div> <!></div>'),_o=v('<p class="mt-1 text-xs text-muted-foreground"> </p>'),ho=v('<p class="mt-1 text-xs text-muted-foreground">Get your API key from POSTECH GenAI Portal</p>'),xo=v('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50"><div class="w-full max-w-md rounded-lg bg-background p-6 shadow-xl"><h2 class="mb-2 text-lg font-semibold">Delete Paper</h2> <p class="mb-4 text-sm text-muted-foreground">Are you sure you want to delete <span class="font-medium text-foreground"> </span>?</p> <p class="mb-6 text-xs text-destructive">This will permanently remove the paper and its PDF file from your library. This action cannot be undone.</p> <div class="flex justify-end gap-2"><button class="rounded-md px-4 py-2 text-sm hover:bg-muted">Cancel</button> <button class="rounded-md bg-destructive px-4 py-2 text-sm text-destructive-foreground hover:bg-destructive/90 disabled:opacity-50"> </button></div></div></div>'),bo=v('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50"><div class="relative h-[80vh] w-full max-w-4xl rounded-lg bg-background shadow-xl overflow-hidden"><button class="absolute right-4 top-4 z-10 rounded p-1 hover:bg-muted"><svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"></path></svg></button> <!></div></div>'),yo=v('<input type="file" accept=".pdf,application/pdf" multiple class="hidden"/> <!> <!> <div class="flex h-full flex-col" role="region" aria-label="Drop zone for PDF files"><div class="flex h-10 items-center border-b bg-muted/50 px-2"><!> <!> <button class="rounded p-1.5 text-muted-foreground hover:bg-muted hover:text-foreground" title="Settings"><svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg></button></div> <div class="flex-1 overflow-hidden"><div><div class="h-full overflow-auto p-6"><h1 class="mb-6 text-2xl font-bold">Paper Library</h1> <div class="mb-6 flex gap-4"><input type="text" placeholder="Search papers..." class="flex-1 rounded-md border bg-background px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary"/> <div class="flex rounded-md border"><button title="Grid view"><svg class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor"><rect x="3" y="3" width="7" height="7" rx="1"></rect><rect x="14" y="3" width="7" height="7" rx="1"></rect><rect x="3" y="14" width="7" height="7" rx="1"></rect><rect x="14" y="14" width="7" height="7" rx="1"></rect></svg></button> <button title="List view"><svg class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor"><rect x="3" y="4" width="18" height="4" rx="1"></rect><rect x="3" y="10" width="18" height="4" rx="1"></rect><rect x="3" y="16" width="18" height="4" rx="1"></rect></svg></button> <button title="Compact view"><svg class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor"><rect x="3" y="5" width="18" height="2" rx="1"></rect><rect x="3" y="9" width="18" height="2" rx="1"></rect><rect x="3" y="13" width="18" height="2" rx="1"></rect><rect x="3" y="17" width="18" height="2" rx="1"></rect></svg></button></div> <button class="rounded-md bg-primary px-4 py-2 text-sm text-primary-foreground hover:bg-primary/90">Add Paper</button></div> <!></div></div> <!> <div><h1 class="mb-6 text-2xl font-bold">Settings</h1> <section class="mb-8"><h2 class="mb-4 text-lg font-semibold">LLM Configuration</h2> <div class="space-y-4 rounded-lg border bg-card p-4"><div><label for="api-key" class="mb-2 block text-sm font-medium">API Key</label> <input id="api-key" type="password" class="w-full rounded-md border bg-background px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary"/> <!></div> <div><label for="model" class="mb-2 block text-sm font-medium">Model</label> <select id="model" class="w-full rounded-md border bg-background px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary"><option>GPT</option><option>Gemini</option><option>Claude</option></select></div> <button class="rounded-md bg-primary px-4 py-2 text-sm text-primary-foreground hover:bg-primary/90 disabled:opacity-50"> </button></div></section> <section class="mb-8"><h2 class="mb-4 text-lg font-semibold">Storage</h2> <div class="space-y-4 rounded-lg border bg-card p-4"><div><label for="pdf-path" class="mb-2 block text-sm font-medium">PDF Storage Path</label> <div class="flex gap-2"><input id="pdf-path" type="text" placeholder="~/.potero/pdfs" class="flex-1 rounded-md border bg-background px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary" readonly=""/> <button class="rounded-md border px-4 py-2 text-sm hover:bg-muted">Browse</button></div></div> <div><p class="text-sm font-medium">Database</p> <p class="mt-1 text-sm text-muted-foreground">~/.potero/potero.db</p></div></div></section> <section class="mb-8"><h2 class="mb-4 text-lg font-semibold">Cloud Sync</h2> <div class="space-y-4 rounded-lg border bg-card p-4"><p class="text-sm text-muted-foreground">Cloud sync with Google Drive and OneDrive coming soon.</p> <button class="rounded-md border px-4 py-2 text-sm hover:bg-muted disabled:opacity-50" disabled>Connect Google Drive</button></div></section> <section class="mb-8"><h2 class="mb-4 text-lg font-semibold">LLM Usage</h2> <div class="space-y-4 rounded-lg border bg-card p-4"><p class="text-sm text-muted-foreground">View LLM API usage logs for debugging and monitoring.</p> <button class="rounded-md border px-4 py-2 text-sm hover:bg-muted">View LLM Logs</button></div></section> <section><h2 class="mb-4 text-lg font-semibold">About</h2> <div class="rounded-lg border bg-card p-4"><p class="font-medium">Potero</p> <p class="mt-1 text-sm text-muted-foreground">Serverless Research Reference Manager</p> <p class="mt-2 text-xs text-muted-foreground">Version 0.1.0 (Development)</p></div></section></div></div></div> <!> <!> <!> <!>',1);function Io(e,t){zt(t,!0);const a=()=>tt(_r,"$searchQuery",re),i=()=>tt(vs,"$filteredPapers",re),u=()=>tt(Ue,"$error",re),c=()=>tt(Zr,"$activeTab",re),l=()=>tt(Dt,"$tabs",re),f=()=>tt(ht,"$activeTabId",re),b=()=>tt(yr,"$isChatPanelOpen",re),C=()=>tt(Wt,"$viewStyle",re),T=()=>tt(ye,"$isLoading",re),de=()=>tt(Yt,"$isSearchingOnline",re),O=()=>tt(hr,"$onlineSearchResults",re),Y=()=>tt(er,"$pendingUploadAnalysis",re),[re,V]=ca();let h=se(!1),k=se(null);jt(()=>import("./dpo3E_rx.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url).then(p=>{y(k,p.default,!0)});let A=se(!1),U=se("file"),R=se(""),I=se(!1),H,z=se(!1),G=se(null),Q=se(!1);async function j(){if(!r(G))return;y(Q,!0),await ms(r(G).id)?Ee.success(`Deleted "${r(G).title}"`):Ee.error("Failed to delete paper"),y(G,null),y(Q,!1)}let K=se(Zt({llmApiKey:null,llmProvider:"gpt",pdfStoragePath:null,theme:"system"})),x=se(""),q=se(!1);xr(()=>{_s(),ge()}),gr(()=>{const p=a(),g=i().length;ps(p,g)});async function ge(){const p=await xe.getSettings();p.success&&p.data&&y(K,p.data,!0)}async function ee(){y(q,!0);const p={llmProvider:r(K).llmProvider,theme:r(K).theme};r(x).trim()&&(p.llmApiKey=r(x));const g=await xe.updateSettings(p);g.success&&g.data&&(y(K,g.data,!0),y(x,"")),y(q,!1)}async function ce(){if(r(U)==="file"){H?.click();return}if(!r(R).trim())return;y(I,!0),(r(U)==="doi"?await fs(r(R)):await gs(r(R)))&&(y(A,!1),y(R,"")),y(I,!1)}async function Me(p){const g=p.target,J=g.files;J&&J.length>0&&(y(I,!0),(await Or(J)).successCount>0&&y(A,!1),y(I,!1)),g.value=""}function S(p){p.preventDefault(),p.stopPropagation(),p.dataTransfer&&(p.dataTransfer.dropEffect="copy"),y(z,!0)}function $(p){p.preventDefault(),p.stopPropagation();const g=p.relatedTarget,J=p.currentTarget;(!g||!J.contains(g))&&y(z,!1)}async function Z(p){p.preventDefault(),p.stopPropagation(),y(z,!1);const g=p.dataTransfer?.files;if(g&&g.length>0){const J=Array.from(g).filter(oe=>oe.type==="application/pdf"||oe.name.toLowerCase().endsWith(".pdf"));if(J.length>0){const ke=J.filter(we=>we.size>52428800);if(ke.length>0){Ee.error(`File too large: ${ke[0].name} (${Math.round(ke[0].size/1024/1024)}MB). Max size is 50MB.`);return}const be=await Or(J);be.successCount>0?Ee.success(`Successfully uploaded ${be.successCount} file${be.successCount>1?"s":""}`):u()&&Ee.error(u())}else Ee.warning("Please drop PDF files only")}}var ue=yo(),Se=qe(ue);Se.__change=Me,Fr(Se,p=>H=p,()=>H);var ne=o(Se,2);{var M=p=>{var g=Mn(),J=n(g),oe=o(n(J),2),ke=n(oe);ke.__click=()=>y(U,"file");var be=o(ke,2);be.__click=()=>y(U,"doi");var we=o(be,2);we.__click=()=>y(U,"arxiv"),s(oe);var Pe=o(oe,2);{var Ke=ie=>{var F=In(),E=o(n(F),4);E.__click=()=>H?.click(),s(F),w(()=>fe(F,1,`mb-4 flex flex-col items-center justify-center rounded-lg border-2 border-dashed p-8 transition-colors
						${r(z)?"border-primary bg-primary/10":"border-muted-foreground/25"}`)),yt("dragenter",F,S),yt("dragover",F,S),yt("dragleave",F,$),yt("drop",F,Z),d(ie,F)},ft=ie=>{var F=Tn();Jt(F),w(()=>Ct(F,"placeholder",r(U)==="doi"?"Enter DOI (e.g., 10.1000/xyz123)":"Enter arXiv ID (e.g., 2301.00001)")),Qt(F,()=>r(R),E=>y(R,E)),d(ie,F)};m(Pe,ie=>{r(U)==="file"?ie(Ke):ie(ft,!1)})}var Je=o(Pe,2);{var L=ie=>{var F=Pn(),E=n(F,!0);s(F),w(()=>_(E,u())),d(ie,F)};m(Je,ie=>{u()&&ie(L)})}var at=o(Je,2),bt=n(at);bt.__click=()=>{y(A,!1),y(R,"")};var At=o(bt,2);{var Mt=ie=>{var F=An();F.__click=ce;var E=n(F,!0);s(F),w(W=>{F.disabled=W,_(E,r(I)?"Importing...":"Import")},[()=>r(I)||!r(R).trim()]),d(ie,F)};m(At,ie=>{r(U)!=="file"&&ie(Mt)})}s(at),s(J),s(g),w(()=>{fe(ke,1,`flex-1 rounded-md px-4 py-2 text-sm transition-colors
						${r(U)==="file"?"bg-primary text-primary-foreground":"bg-muted"}`),fe(be,1,`flex-1 rounded-md px-4 py-2 text-sm transition-colors
						${r(U)==="doi"?"bg-primary text-primary-foreground":"bg-muted"}`),fe(we,1,`flex-1 rounded-md px-4 py-2 text-sm transition-colors
						${r(U)==="arxiv"?"bg-primary text-primary-foreground":"bg-muted"}`)}),d(p,g)};m(ne,p=>{r(A)&&p(M)})}var P=o(ne,2);{var D=p=>{var g=Ln();d(p,g)};m(P,p=>{r(z)&&c()?.type==="home"&&p(D)})}var me=o(P,2),$e=n(me),Oe=n($e);it(Oe,1,l,p=>p.id,(p,g)=>{var J=Rn();J.__click=()=>ht.set(r(g).id);var oe=n(J),ke=n(oe,!0);s(oe);var be=o(oe,2);{var we=Pe=>{var Ke=Dn();Ke.__click=ft=>{ft.stopPropagation(),ea(r(g).id)},d(Pe,Ke)};m(be,Pe=>{r(g).id!=="home"&&Pe(we)})}s(J),w(()=>{fe(J,1,`flex h-8 items-center gap-2 rounded-t-md border-b-2 px-3 text-sm transition-colors
					${f()===r(g).id?"border-primary bg-background text-foreground":"border-transparent text-muted-foreground hover:text-foreground"}`),_(ke,r(g).title)}),d(p,J)});var Xe=o(Oe,2);{var te=p=>{var g=$n();g.__click=()=>Yr(),w(()=>{fe(g,1,`ml-auto rounded p-1.5 transition-colors ${b()?"bg-primary text-primary-foreground":"text-muted-foreground hover:bg-muted hover:text-foreground"}`),Ct(g,"title",b()?"Close Chat":"Chat with Paper")}),d(p,g)},ve=p=>{var g=Nn();d(p,g)};m(Xe,p=>{c()?.type==="viewer"?p(te):p(ve,!1)})}var Le=o(Xe,2);Le.__click=()=>ta(),s($e);var lt=o($e,2),dt=n(lt),Ve=n(dt),Fe=o(n(Ve),2),pt=n(Fe);Jt(pt);var rt=o(pt,2),Qe=n(rt);Qe.__click=()=>Wt.set("grid");var He=o(Qe,2);He.__click=()=>Wt.set("list");var Ye=o(He,2);Ye.__click=()=>Wt.set("compact"),s(rt);var Nt=o(rt,2);Nt.__click=()=>y(A,!0),s(Fe);var xt=o(Fe,2);{var Ut=p=>{var g=Un();d(p,g)},It=p=>{var g=vt(),J=qe(g);{var oe=be=>{var we=On(),Pe=o(n(we),6);Pe.__click=()=>y(A,!0),s(we),w(()=>fe(we,1,`flex flex-col items-center justify-center rounded-lg border-2 border-dashed py-16 text-muted-foreground transition-colors
							${r(z)?"border-primary bg-primary/10":"border-muted-foreground/25"}`)),d(be,we)},ke=be=>{var we=co(),Pe=qe(we);it(Pe,5,i,Je=>Je.id,(Je,L)=>{var at=vt(),bt=qe(at);{var At=ie=>{var F=Hn();F.__click=()=>{jt(async()=>{const{openPaper:N}=await Promise.resolve().then(()=>vr);return{openPaper:N}},void 0,import.meta.url).then(({openPaper:N})=>N(r(L)))};var E=n(F);E.__click=N=>{N.stopPropagation(),y(G,r(L),!0)};var W=o(E,2),Be=n(W,!0);s(W);var X=o(W,2),_e=n(X);s(X);var le=o(X,2),Ae=n(le);{var ze=N=>{var he=Vn(),Ge=n(he,!0);s(he),w(()=>_(Ge,r(L).year)),d(N,he)};m(Ae,N=>{r(L).year&&N(ze)})}var st=o(Ae,2);{var je=N=>{const he=Et(()=>Vr(r(L).conference));var Ge=Fn(),Lt=n(Ge,!0);s(Ge),w(()=>{Ct(Ge,"title",r(he).full??void 0),_(Lt,r(he).display)}),d(N,Ge)};m(st,N=>{r(L).conference&&N(je)})}var nt=o(st,2);{var ot=N=>{var he=Bn();d(N,he)},Ze=N=>{var he=zn(),Ge=n(he);s(he),w(()=>_(Ge,`${r(L).citations??""} citations`)),d(N,he)};m(nt,N=>{r(L).pdfUrl?N(ot):N(Ze,!1)})}s(le);var et=o(le,2);{var Ce=N=>{var he=qn();it(he,21,()=>r(L).subject.slice(0,3),Rt,(Ge,Lt)=>{var ae=Gn(),B=n(ae,!0);s(ae),w(()=>_(B,r(Lt))),d(Ge,ae)}),s(he),d(N,he)};m(et,N=>{r(L).subject.length>0&&N(Ce)})}s(F),w(N=>{_(Be,r(L).title),_(_e,`${N??""}
										${r(L).authors.length>3?` +${r(L).authors.length-3}`:""}`)},[()=>r(L).authors.slice(0,3).join(", ")]),d(ie,F)},Mt=ie=>{var F=vt(),E=qe(F);{var W=X=>{var _e=Xn();_e.__click=()=>{jt(async()=>{const{openPaper:ae}=await Promise.resolve().then(()=>vr);return{openPaper:ae}},void 0,import.meta.url).then(({openPaper:ae})=>ae(r(L)))};var le=n(_e),Ae=n(le),ze=n(Ae,!0);s(Ae);var st=o(Ae,2),je=n(st,!0);s(st),s(le);var nt=o(le,2),ot=n(nt);{var Ze=ae=>{var B=jn(),pe=n(B,!0);s(B),w(()=>_(pe,r(L).year)),d(ae,B)};m(ot,ae=>{r(L).year&&ae(Ze)})}var et=o(ot,2);{var Ce=ae=>{const B=Et(()=>Vr(r(L).conference));var pe=Kn(),gt=n(pe,!0);s(pe),w(()=>{Ct(pe,"title",r(B).full??void 0),_(gt,r(B).display)}),d(ae,pe)};m(et,ae=>{r(L).conference&&ae(Ce)})}var N=o(et,2);{var he=ae=>{var B=Jn();d(ae,B)},Ge=ae=>{var B=Wn(),pe=n(B);s(B),w(()=>_(pe,`${r(L).citations??""} citations`)),d(ae,B)};m(N,ae=>{r(L).pdfUrl?ae(he):ae(Ge,!1)})}var Lt=o(N,2);Lt.__click=ae=>{ae.stopPropagation(),y(G,r(L),!0)},s(nt),s(_e),w(ae=>{_(ze,r(L).title),_(je,ae)},[()=>r(L).authors.join(", ")]),d(X,_e)},Be=X=>{var _e=Zn();_e.__click=()=>{jt(async()=>{const{openPaper:Ce}=await Promise.resolve().then(()=>vr);return{openPaper:Ce}},void 0,import.meta.url).then(({openPaper:Ce})=>Ce(r(L)))};var le=n(_e);{var Ae=Ce=>{var N=Qn();d(Ce,N)};m(le,Ce=>{r(L).pdfUrl&&Ce(Ae)})}var ze=o(le,2),st=n(ze,!0);s(ze);var je=o(ze,2),nt=n(je,!0);s(je);var ot=o(je,2);{var Ze=Ce=>{var N=Yn(),he=n(N,!0);s(N),w(()=>_(he,r(L).year)),d(Ce,N)};m(ot,Ce=>{r(L).year&&Ce(Ze)})}var et=o(ot,2);et.__click=Ce=>{Ce.stopPropagation(),y(G,r(L),!0)},s(_e),w(()=>{_(st,r(L).title),_(nt,r(L).authors[0])}),d(X,_e)};m(E,X=>{C()==="list"?X(W):X(Be,!1)},!0)}d(ie,F)};m(bt,ie=>{C()==="grid"?ie(At):ie(Mt,!1)})}d(Je,at)}),s(Pe);var Ke=o(Pe,2);{var ft=Je=>{var L=lo(),at=n(L),bt=o(n(at),2);{var At=E=>{var W=eo();d(E,W)};m(bt,E=>{de()&&E(At)})}s(at);var Mt=o(at,2);{var ie=E=>{var W=oo();it(W,5,()=>O().slice(0,6),Rt,(Be,X)=>{var _e=no(),le=n(_e),Ae=n(le,!0);s(le);var ze=o(le,2),st=n(ze);s(ze);var je=o(ze,2),nt=n(je);{var ot=B=>{var pe=to(),gt=n(pe,!0);s(pe),w(()=>_(gt,r(X).year)),d(B,pe)};m(nt,B=>{r(X).year&&B(ot)})}var Ze=o(nt,2);{var et=B=>{var pe=ro(),gt=n(pe,!0);s(pe),w(()=>_(gt,r(X).venue)),d(B,pe)};m(Ze,B=>{r(X).venue&&B(et)})}var Ce=o(Ze,2);{var N=B=>{var pe=ao(),gt=n(pe);s(pe),w(()=>_(gt,`${r(X).citationCount??""} citations`)),d(B,pe)};m(Ce,B=>{r(X).citationCount&&B(N)})}s(je);var he=o(je,2),Ge=n(he);Ge.__click=async()=>{const B=await ys(r(X));B?Ee.success(`Added "${B.title}" to library`):Ee.error("Failed to import paper")};var Lt=o(Ge,2);{var ae=B=>{var pe=so();pe.__click=gt=>gt.stopPropagation(),w(()=>Ct(pe,"href",r(X).pdfUrl)),d(B,pe)};m(Lt,B=>{r(X).pdfUrl&&B(ae)})}s(he),s(_e),w(B=>{_(Ae,r(X).title),_(st,`${B??""}
												${r(X).authors.length>2?` +${r(X).authors.length-2}`:""}`)},[()=>r(X).authors.slice(0,2).join(", ")]),d(Be,_e)}),s(W),d(E,W)},F=E=>{var W=vt(),Be=qe(W);{var X=_e=>{var le=io(),Ae=n(le);s(le),w(()=>_(Ae,`No online results found for "${a()??""}"`)),d(_e,le)};m(Be,_e=>{de()||_e(X)},!0)}d(E,W)};m(Mt,E=>{O().length>0?E(ie):E(F,!1)})}s(L),d(Je,L)};m(Ke,Je=>{a().length>=3&&i().length<3&&Je(ft)})}w(()=>fe(Pe,1,Ja(C()==="grid"?"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3":C()==="list"?"flex flex-col gap-3":"flex flex-col gap-1"))),d(be,we)};m(J,be=>{i().length===0?be(oe):be(ke,!1)},!0)}d(p,g)};m(xt,p=>{T()?p(Ut):p(It,!1)})}s(Ve),s(dt);var Tt=o(dt,2);it(Tt,1,()=>l().filter(p=>p.type==="viewer"),p=>p.id,(p,g)=>{var J=mo(),oe=n(J),ke=n(oe),be=n(ke),we=n(be),Pe=n(we,!0);s(we);var Ke=o(we,2);{var ft=E=>{var W=uo(),Be=n(W);s(W),w(()=>_(Be,`(${r(g).paper.year??""})`)),d(E,W)};m(Ke,E=>{r(g).paper?.year&&E(ft)})}s(be);var Je=o(be,2),L=n(Je);L.__click=async()=>{if(!r(g).paper?.id)return;Ee.info("Re-analyzing PDF...");const E=await hs(r(g).paper.id);E?.autoResolved?Ee.success("Metadata updated successfully"):E?.needsUserConfirmation?Ee.info("Please select the correct paper from search results"):E&&Ee.warning("No metadata found")};var at=o(L,2);at.__click=async()=>{if(!r(g).paper?.id)return;Ee.info("Generating tags with AI...");const E=await xs(r(g).paper.id);E&&E.assignedTags.length>0?Ee.success(`Added ${E.assignedTags.length} tags: ${E.assignedTags.map(W=>W.name).join(", ")}`):Ee.warning("Could not generate tags")},s(Je),s(ke);var bt=o(ke,2);{var At=E=>{var W=vt(),Be=qe(W);va(Be,()=>r(k),(X,_e)=>{_e(X,{get pdfUrl(){return r(g).paper.pdfUrl},get tabId(){return r(g).id},get initialState(){return r(g).viewerState}})}),d(E,W)},Mt=E=>{var W=vt(),Be=qe(W);{var X=le=>{var Ae=vo();d(le,Ae)},_e=le=>{var Ae=fo(),ze=o(n(Ae),2),st=n(ze,!0);s(ze);var je=o(ze,4);{var nt=Ze=>{var et=po(),Ce=n(et,!0);s(et),w(()=>_(Ce,r(g).paper.abstract)),d(Ze,et)};m(je,Ze=>{r(g).paper?.abstract&&Ze(nt)})}var ot=o(je,2);ot.__click=()=>{Ee.info("PDF upload for existing papers coming soon")},s(Ae),w(()=>_(st,r(g).paper?.title)),d(le,Ae)};m(Be,le=>{r(g).paper?.pdfUrl&&!r(k)?le(X):le(_e,!1)},!0)}d(E,W)};m(bt,E=>{r(g).paper?.pdfUrl&&r(k)?E(At):E(Mt,!1)})}s(oe);var ie=o(oe,2);{var F=E=>{var W=go(),Be=n(W);{let X=Et(()=>r(g).paper??null);$s(Be,{get paper(){return r(X)}})}s(W),d(E,W)};m(ie,E=>{b()&&E(F)})}s(J),w(()=>{fe(J,1,`flex h-full ${f()===r(g).id?"":"hidden"}`),_(Pe,r(g).paper?.title)}),d(p,J)});var Ie=o(Tt,2),De=o(n(Ie),2),ct=o(n(De),2),Te=n(ct),Ne=o(n(Te),2);Jt(Ne);var ut=o(Ne,2);{var Pt=p=>{var g=_o(),J=n(g);s(g),w(()=>_(J,`Current key: ${r(K).llmApiKey??""}`)),d(p,g)},aa=p=>{var g=ho();d(p,g)};m(ut,p=>{r(K).llmApiKey?p(Pt):p(aa,!1)})}s(Te);var tr=o(Te,2),rr=o(n(tr),2),ar=n(rr);ar.value=ar.__value="gpt";var sr=o(ar);sr.value=sr.__value="gemini";var wr=o(sr);wr.value=wr.__value="claude",s(rr),s(tr);var Ht=o(tr,2);Ht.__click=ee;var sa=n(Ht,!0);s(Ht),s(ct),s(De);var nr=o(De,2),Cr=o(n(nr),2),Er=n(Cr),kr=o(n(Er),2),Sr=n(kr);Jt(Sr),Ot(2),s(kr),s(Er),Ot(2),s(Cr),s(nr);var Ir=o(nr,4),Tr=o(n(Ir),2),na=o(n(Tr),2);na.__click=()=>y(h,!0),s(Tr),s(Ir),Ot(2),s(Ie),s(lt),s(me);var Pr=o(me,2);{var oa=p=>{Hs(p,{get paperId(){return Y().paperId},get searchQuery(){return Y().searchQuery},get results(){return Y().searchResults},onConfirm:async()=>{Ur(),await kt()},onCancel:()=>{Ur()}})};m(Pr,p=>{Y()&&p(oa)})}var Ar=o(Pr,2);on(Ar,{});var Mr=o(Ar,2);{var ia=p=>{var g=xo(),J=n(g),oe=o(n(J),2),ke=o(n(oe)),be=n(ke);s(ke),Ot(),s(oe);var we=o(oe,4),Pe=n(we);Pe.__click=()=>y(G,null);var Ke=o(Pe,2);Ke.__click=j;var ft=n(Ke,!0);s(Ke),s(we),s(J),s(g),w(()=>{_(be,`"${r(G).title??""}"`),Pe.disabled=r(Q),Ke.disabled=r(Q),_(ft,r(Q)?"Deleting...":"Delete")}),d(p,g)};m(Mr,p=>{r(G)&&p(ia)})}var la=o(Mr,2);{var da=p=>{var g=bo(),J=n(g),oe=n(J);oe.__click=()=>y(h,!1);var ke=o(oe,2);Cn(ke,{}),s(J),s(g),d(p,g)};m(la,p=>{r(h)&&p(da)})}w(()=>{fe(dt,1,`h-full ${c()?.type==="home"?"":"hidden"}`),fe(Qe,1,`px-3 py-2 text-sm transition-colors ${C()==="grid"?"bg-primary text-primary-foreground":"hover:bg-muted"}`),fe(He,1,`px-3 py-2 text-sm transition-colors ${C()==="list"?"bg-primary text-primary-foreground":"hover:bg-muted"}`),fe(Ye,1,`px-3 py-2 text-sm transition-colors ${C()==="compact"?"bg-primary text-primary-foreground":"hover:bg-muted"}`),fe(Ie,1,`h-full overflow-auto p-6 ${c()?.type==="settings"?"":"hidden"}`),Ct(Ne,"placeholder",r(K).llmApiKey?"API key is set (enter new to change)":"Enter your POSTECH GenAI API key"),Ht.disabled=r(q),_(sa,r(q)?"Saving...":"Save Settings"),ts(Sr,r(K).pdfStoragePath??"~/.potero/pdfs")}),yt("dragenter",me,S),yt("dragover",me,S),yt("dragleave",me,$),yt("drop",me,Z),Qt(pt,a,p=>ua(_r,p)),Qt(Ne,()=>r(x),p=>y(x,p)),Xr(rr,()=>r(K).llmProvider,p=>r(K).llmProvider=p),d(e,ue),Gt(),V()}qt(["change","click"]);export{Io as _,Qt as b,Jt as r,fe as s,ns as u};
